# PostingFotoTG (v2.0)

## üöÄ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç:
- –ü–æ–ª—É—á–∞–µ—Ç —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ Bitrix –ø–æ `folder_id`
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª—ã –≤ —Å–¥–µ–ª–∫—É Bitrix24 (–ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç –∫ –ø–æ–ª—é)
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ –≤ Telegram —á–µ—Ä–µ–∑ `sendMediaGroup`
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å—å –∫ —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ GPT –∏–ª–∏ fallback —Ç–µ–∫—Å—Ç

---

## üìÇ –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:

| –§–∞–π–ª                | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                  |
|---------------------|--------------------------------------------|
| `app.py`            | FastAPI —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞                        |
| `webhook.py`        | –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook —Å–æ–±—ã—Ç–∏–π Bitrix           |
| `services.py`       | –õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç—á—ë—Ç–∞   |
| `bitrix.py`         | –†–∞–±–æ—Ç–∞ —Å Bitrix API (—Å–¥–µ–ª–∫–∏, —Ñ–∞–π–ª—ã)         |
| `telegram.py`       | –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ –≤ Telegram             |
| `gpt.py`            | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–µ–π —á–µ—Ä–µ–∑ OpenAI GPT        |
| `config.py`         | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞                         |
| `utils/formatting.py`| –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç, fallback —Ç–µ–∫—Å—Ç         |
| `utils/prompts.py`  | –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ GPT                 |
| `requirements.txt`  | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞                       |
| `tests/`            | –¢–µ—Å—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞                             |

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
- **FastAPI** + **Uvicorn**
- **Bitrix24 REST API**
- **Telegram Bot API**
- **OpenAI GPT-3.5/4**
- **httpx** / **aiohttp** / **requests**

---

## üì¨ –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–æ—É—Ç—ã:

| –ú–µ—Ç–æ–¥ | URL                   | –û–ø–∏—Å–∞–Ω–∏–µ                         |
|-------|------------------------|----------------------------------|
| POST  | `/webhook/register_folder` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–∞–ø–∫–∏ —Ñ–∞–π–ª–æ–≤ –ø–æ —Å–¥–µ–ª–∫–µ |
| POST  | `/webhook/deal_update`     | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏ (–¥–ª—è Bitrix)|

---

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- Python 3.11+
- –§–∞–π–ª `.env`:
```env
BITRIX_WEBHOOK=https://yourdomain.bitrix24.ru/rest/1/...
TG_GITHUB_BOT=your-bot-token
TG_CHAT_ID=your-chat-id
OPENAI_API_KEY=your-openai-key
FILE_FIELD_ID=UF_CRM_1740994275251
FOLDER_FIELD_ID=UF_CRM_1743273170850
```

---

‚úÖ –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é –∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–∞–Ω–∏–∏ üöÄ